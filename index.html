<!DOCTYPE html>
<html lang="en">
  
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Journal's metadata</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            margin: 0;
            padding: 0;
            background-color: #FFFFFF; /* Light blue background */
        }

        .header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 10px 20px;
            background-color: #FFFFFF; /* Blue header */
            color: white;
        }
    
        .header img {
            max-width: 150px;
            height: auto;
        }
    
        .developer {
            font-size: 12px;
            color: rgb(15, 1, 1);
        }
        /* Footer layout */
.footer-content {
    display: flex;
    justify-content: space-between; /* Space between left, center, and right */
    align-items: center; /* Vertically align items */
    flex-wrap: wrap; /* Allow wrapping for small screens */
    text-align: center;
    width: 90%;
    margin: 0 auto;
}

/* Footer center content */
.footer-center {
    flex: 1; /* Allow it to occupy the middle space */
    text-align: center;
    font-weight: bold;
}

/* Footer right content */
.footer-right {
    text-align: right;
    flex: 1; /* Align the right section properly */
    font-size: 14px;
}

/* Footer link styles */
.footer-link {
    color: #004085; /* Dark blue text */
    text-decoration: none; /* Remove underline by default */
    font-weight: bold; /* Bold text */
    font-size: 14px; /* Match desired size */
}

.footer-link:hover {
    text-decoration: underline; /* Underline on hover */
    color: #007bff; /* Slightly lighter blue on hover */
}

.footer p {
    margin: 5px 0; /* Clean spacing between lines */
}

        
        h1 {
            text-align: center;
            margin: 20px 0;
            color: #0056b3; /* Darker blue */
        }
    
        table {
            border-collapse: collapse;
            width: 90%;
            margin: 20px auto;
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.2);
            background-color: white;
        }
    
        th, td {
            border: 1px solid #ddd;
            text-align: left;
            padding: 10px;
        }
    
        th {
            background-color: #cce5ff; /* Light blue for headers */
            color: #004085; /* Dark blue text */
            font-weight: bold;
        }
    
        tr:nth-child(even) {
            background-color: #e9f7ff; /* Subtle blue for alternating rows */
        }
    
        tr:hover {
            background-color: #b3d9ff; /* Highlighted blue */
            cursor: pointer;
        }
    
        tr.selected {
            background-color: #007bff; /* Blue for selected row */
            color: white;
        }
/* Default light blue arrow for sortable headers */
th.sortable::after {
    content: " ▲"; /* Default ascending arrow */
    color: rgb(149, 184, 227); /* Light blue */
    font-size: 0.8em;
    visibility: visible; /* Always visible */
}

/* Style when column is being sorted in ascending order */
th.sortable.ascending::after {
    content: " ▲"; /* Ascending arrow */
    color: #007bff; /* Dark blue */
}

/* Style when column is being sorted in descending order */
th.sortable.descending::after {
    content: " ▼"; /* Descending arrow */
    color: #007bff; /* Dark blue */
}
th.sortable:hover {
    background-color: #0056b3;
    color: white;
    cursor: pointer;
}


        .filter-input {
            width: 100%;
            padding: 5px;
            margin-bottom: 5px;
            border: 1px solid #007bff;
            border-radius: 4px;
            box-sizing: border-box;
        }
    
        .filter-input:focus {
            outline: 2px solid #0056b3; /* Focus on inputs */
        }
   
        
        .pagination {
            display: flex;
            justify-content: center;
            align-items: center;
            margin: 20px 0;
            font-family: Arial, sans-serif;
        }
        
        .pagination button, .pagination span {
            padding: 8px 12px;
            margin: 0 2px;
            border: 1px solid #ccc;
            border-radius: 4px;
            background-color: #fff;
            color: #007bff;
            cursor: pointer;
            text-decoration: none;
            font-size: 14px;
            transition: background-color 0.3s, border-color 0.3s;
        }
        
        .pagination button:hover {
            background-color: #e9ecef;
            border-color: #007bff;
        }
        
        .pagination button:disabled {
            background-color: #f8f9fa;
            color: #aaa;
            border-color: #ddd;
            cursor: not-allowed;
        }
        
        .pagination .active {
            background-color: #007bff;
            color: white;
            border-color: #007bff;
            cursor: default;
        }
        
        .pagination span {
            background-color: transparent;
            border: none;
            color: #6c757d;
            cursor: default;
            padding: 8px 6px;
        }
        /* AIS Ratio Box Styling */
.ais-box {
    background-color: #f8f9fa; /* Light gray background */
    border: 1px solid #ddd; /* Subtle border */
    border-radius: 8px; /* Rounded corners */
    padding: 15px 20px;
    margin: 20px auto; /* Space above and below */
    width: 90%;
    box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1); /* Light box shadow */
    font-family: Arial, sans-serif;
    line-height: 1.6;
}

/* Center the formula and align AIS Ratio */
.ais-formula {
    text-align: center;
    position: relative;
}

.fraction {
    display: inline-block;
    text-align: center;
    position: relative;
    line-height: 1.2;
}

.formula-line {
    border: none;
    border-top: 2px solid #000;
    width: 120px;
    margin: 4px auto;
}

.ais-ratio {
    font-weight: bold;
    font-size: 18px;
    position: relative;
    top: -17px; /* Adjust upward movement */
    display: inline-block;
}

.autocomplete-suggestions {
    max-height: 150px;
    overflow-y: auto;
    position: absolute;
    background: white;
    z-index: 1000;
    width: calc(100% - 2px); /* Match input width */
}
.autocomplete-suggestion {
    padding: 5px;
    cursor: pointer;
}
.autocomplete-suggestion:hover {
    background-color: #f0f0f0;
}

strong {
    color: #0056b3; /* Highlighted blue for strong text */
}
.compare-checkbox {
    transform: scale(1.2);
    cursor: pointer;
}

#comparison-container {
    display: none;
    width: 90%;
    margin: 20px auto;
    padding: 15px;
    border: 1px solid #ccc;
    background: #f9f9f9;
    box-shadow: 0 2px 6px rgba(0,0,0,0.1);
}

#comparison-container table {
    width: 100%;
    border-collapse: collapse;
}

#comparison-container th, #comparison-container td {
    border: 1px solid #999;
    padding: 8px;
    text-align: center;
}

#compare-btn {
    background-color: #007bff;
    color: white;
    border: none;
    padding: 10px 16px;
    margin: 20px auto;
    cursor: pointer;
    border-radius: 6px;
    font-size: 16px;
    display: block;
}

#compare-btn:hover {
    background-color: #0056b3;
}
.remove-btn {
    background-color: #dc3545;
    color: white;
    border: none;
    padding: 4px 8px;
    border-radius: 4px;
    cursor: pointer;
}
.remove-btn:hover {
    background-color: #c82333;
}

</style>
</head>
<body>
    <div class="header">
        <img src="image/icon.jpg" alt="ICON">
        <div class="developer">Developed by Ismael Soto (isma-sa@hotmail.com)</div>
    </div>
    <h1>Journal's metadata</h1>
    <div class="ais-box">
        <p>
            <strong>Ranking</strong> refers to the journal's position in the <strong>given Category</strong> (according to the AIS scores).

        <p>
            <strong>AIS Quartile</strong> are based on the <strong>Ranking</strong>.
        </p>
        </div>

    </div>
    
    <table id="tabla-datos">
        <thead>
          <tr>
            <th>Compare</th> <!-- new column -->
            <th>
              <input id="journal-filter" class="filter-input" type="text" placeholder="Type journal name">
              <div id="journal-suggestions" class="autocomplete-suggestions"></div>
              Journal
            </th>
            <th>Year</th>
            <th><input class="filter-input" type="text" placeholder="USE EXACT NAME">Category</th>
            <th class="sortable" data-column="3" data-order="none">Impact Factor</th>
            <th class="sortable" data-column="4" data-order="desc">Article Influence Score</th>
            <th>Ranking</th>
            <th data-column="5" data-order="none">AIS Quartile</th>
            <th>Database</th>
          </tr>
        </thead>
        <tbody></tbody>
      </table>
    
      <!-- Compare Button -->
      <button id="compare-btn">Compare Selected Journals</button>
    
      <!-- Comparison Output -->
      <div id="comparison-container"></div>
    
      <div class="pagination" id="pagination"></div>
    
      <script>
        const rowsPerPage = 20;
        let currentPage = 1;
        let filteredData = [];
        let originalData = [];
    
        function renderTableRows(data) {
          const tableBody = document.getElementById('tabla-datos').getElementsByTagName('tbody')[0];
          tableBody.innerHTML = '';
          const startIndex = (currentPage - 1) * rowsPerPage;
          const endIndex = Math.min(startIndex + rowsPerPage, data.length);
    
          for (let i = startIndex; i < endIndex; i++) {
            const row = tableBody.insertRow();
            row.classList.add('data-row');
    
            // Add compare checkbox
            const compareCell = row.insertCell();
            const checkbox = document.createElement('input');
            checkbox.type = 'checkbox';
            checkbox.className = 'compare-checkbox';
            checkbox.dataset.journal = data[i][0];
            compareCell.appendChild(checkbox);
    
            data[i].forEach(cell => {
              const newCell = row.insertCell();
              newCell.textContent = cell;
            });
    
            row.addEventListener('click', () => {
              document.querySelectorAll('.data-row').forEach(r => r.classList.remove('selected'));
              row.classList.add('selected');
            });
          }
        }
    
        function updatePagination(totalRows) {
          const paginationDiv = document.getElementById('pagination');
          paginationDiv.innerHTML = '';
          const totalPages = Math.ceil(totalRows / rowsPerPage);
          const maxVisiblePages = 5;
    
          const createPageButton = (text, isActive, callback) => {
            const button = document.createElement('button');
            button.textContent = text;
            if (isActive) button.classList.add('active');
            button.addEventListener('click', callback);
            return button;
          };
    
          const prevButton = createPageButton('Previous', false, () => {
            if (currentPage > 1) {
              currentPage--;
              renderTableRows(filteredData);
              updatePagination(filteredData.length);
            }
          });
          prevButton.disabled = currentPage === 1;
          paginationDiv.appendChild(prevButton);
    
          let startPage = Math.max(1, currentPage - Math.floor(maxVisiblePages / 2));
          let endPage = Math.min(totalPages, startPage + maxVisiblePages - 1);
          if (endPage - startPage + 1 < maxVisiblePages) {
            startPage = Math.max(1, endPage - maxVisiblePages + 1);
          }
    
          if (startPage > 1) {
            paginationDiv.appendChild(createPageButton(1, currentPage === 1, () => {
              currentPage = 1;
              renderTableRows(filteredData);
              updatePagination(filteredData.length);
            }));
            paginationDiv.appendChild(document.createElement('span')).textContent = '...';
          }
    
          for (let i = startPage; i <= endPage; i++) {
            paginationDiv.appendChild(createPageButton(i, currentPage === i, () => {
              currentPage = i;
              renderTableRows(filteredData);
              updatePagination(filteredData.length);
            }));
          }
    
          if (endPage < totalPages) {
            paginationDiv.appendChild(document.createElement('span')).textContent = '...';
            paginationDiv.appendChild(createPageButton(totalPages, currentPage === totalPages, () => {
              currentPage = totalPages;
              renderTableRows(filteredData);
              updatePagination(filteredData.length);
            }));
          }
    
          const nextButton = createPageButton('Next', false, () => {
            if (currentPage < totalPages) {
              currentPage++;
              renderTableRows(filteredData);
              updatePagination(filteredData.length);
            }
          });
          nextButton.disabled = currentPage === totalPages;
          paginationDiv.appendChild(nextButton);
        }
    
        function filterData() {
          const journalInput = document.getElementById('journal-filter').value.trim().toLowerCase();
          const categoryInput = document.querySelectorAll('.filter-input')[1].value.trim().toLowerCase();
    
          filteredData = originalData.filter(row => {
            const journalMatch = row[0].toLowerCase().includes(journalInput);
            const normalize = str => str.toLowerCase().trim().normalize("NFD").replace(/[\u0300-\u036f]/g, "");
            const categoryMatch = categoryInput === "" || normalize(row[2]) === normalize(categoryInput);
                        return journalMatch && categoryMatch;
          });
    
          currentPage = 1;
          renderTableRows(filteredData);
          updatePagination(filteredData.length);
        }
    
        function showSuggestions(input, suggestions) {
          const suggestionsContainer = document.getElementById('journal-suggestions');
          suggestionsContainer.innerHTML = suggestions.map(journal => `
            <div class="autocomplete-suggestion">${journal}</div>
          `).join('');
    
          document.querySelectorAll('.autocomplete-suggestion').forEach(suggestion => {
            suggestion.addEventListener('click', () => {
              document.getElementById('journal-filter').value = suggestion.textContent;
              suggestionsContainer.innerHTML = '';
              filterData();
            });
          });
        }
    
        function updateSuggestions() {
          const input = document.getElementById('journal-filter').value.trim().toLowerCase();
          if (input === '') {
            document.getElementById('journal-suggestions').innerHTML = '';
            return;
          }
    
          const suggestions = originalData
            .map(row => row[0])
            .filter((journal, index, self) => self.indexOf(journal) === index)
            .filter(journal => journal.toLowerCase().includes(input))
            .slice(0, 5);
    
          showSuggestions(input, suggestions);
        }
    
        document.getElementById('journal-filter').addEventListener('input', () => {
          updateSuggestions();
          filterData();
        });
    
        document.getElementById('journal-filter').addEventListener('keydown', function(event) {
          if (event.key === 'Enter') {
            document.getElementById('journal-suggestions').innerHTML = '';
          }
        });
    
        document.getElementById('compare-btn').addEventListener('click', () => {
            const selectedJournals = Array.from(document.querySelectorAll('.compare-checkbox:checked'))
                .map(checkbox => checkbox.dataset.journal);
        
            if (selectedJournals.length < 2) {
                alert('Please select at least two journals to compare.');
                return;
            }
        
            const comparisonRows = filteredData.filter(row => selectedJournals.includes(row[0]));
        
            let html = `<h3>Journal Comparison</h3>
                        <table>
                            <thead>
                                <tr>
                                    <th>Journal</th>
                                    <th>Category</th>
                                    <th>Impact Factor</th>
                                    <th>AIS</th>
                                    <th>Ranking</th>
                                    <th>Quartile</th>
                                    <th>Remove</th>
                                </tr>
                            </thead>
                            <tbody id="comparison-table-body">`;
        
            comparisonRows.forEach(row => {
                html += `<tr data-journal="${row[0]}">
                            <td>${row[0]}</td>  <!-- Journal -->
                            <td>${row[2]}</td>  <!-- Category -->
                            <td>${row[3]}</td>  <!-- Impact Factor -->
                            <td>${row[4]}</td>  <!-- AIS -->
                            <td>${row[5]}</td>  <!-- Ranking -->
                            <td>${row[6]}</td>  <!-- Quartile -->
                           <td><button class="remove-btn" title="Remove">&#128465;</button></td> <!-- 🗑️ -->
                         </tr>`;
            });
        
            html += `</tbody></table>`;
        
            const container = document.getElementById('comparison-container');
            container.innerHTML = html;
            container.style.display = 'block';
        
            // Add remove logic to each remove button
            document.querySelectorAll('.remove-btn').forEach(button => {
                button.addEventListener('click', function () {
                    const row = this.closest('tr');
                    const journal = row.dataset.journal;
        
                    // Remove from table
                    row.remove();
        
                    // Uncheck the corresponding checkbox
                    document.querySelectorAll('.compare-checkbox').forEach(checkbox => {
                        if (checkbox.dataset.journal === journal) {
                            checkbox.checked = false;
                        }
                    });
        
                    // Hide comparison container if no rows left
                    if (document.querySelectorAll('#comparison-table-body tr').length === 0) {
                        container.style.display = 'none';
                    }
                });
            });
        });

        function sortTable(columnIndex, headerElement) {
          const order = headerElement.dataset.order === "asc" ? "desc" : "asc";
      
          // Copy data to sort: use originalData if no filters are applied
          const dataToSort = filteredData.length === originalData.length ? [...originalData] : [...filteredData];
      
          // Sort data based on column index
          dataToSort.sort((a, b) => {
              let valueA = a[columnIndex] || 0; // Default to 0 for empty or missing values
              let valueB = b[columnIndex] || 0;
      
              // Ensure numeric comparison
              if (!isNaN(valueA) && !isNaN(valueB)) {
                  valueA = parseFloat(valueA);
                  valueB = parseFloat(valueB);
              } else {
                  // Fallback to text comparison for non-numeric values
                  valueA = valueA.toString().toLowerCase();
                  valueB = valueB.toString().toLowerCase();
              }
      
              // Ascending and descending sorting
              if (order === "asc") {
                  return valueA > valueB ? 1 : valueA < valueB ? -1 : 0;
              } else {
                  return valueA < valueB ? 1 : valueA > valueB ? -1 : 0;
              }
          });
        
filteredData = [...dataToSort];
    currentPage = 1;

    // Reset all header indicators and update current header
    document.querySelectorAll("th.sortable").forEach(th => {
        th.dataset.order = "none";
        th.classList.remove("ascending", "descending");
    });
    headerElement.dataset.order = order;
    headerElement.classList.add(order === "asc" ? "ascending" : "descending");

    // Re-render table
    renderTableRows(filteredData);
    updatePagination(filteredData.length);
}

// Attach sorting functionality to sortable headers
document.querySelectorAll("th.sortable").forEach((th) => {
    th.addEventListener("click", () => {
        const columnIndex = parseInt(th.dataset.column);
        sortTable(columnIndex, th);
    });
});

// Function to apply filters
function filterData() {
  const journalInput = document.getElementById('journal-filter').value.trim().toLowerCase();
  const categoryInput = document.querySelectorAll('.filter-input')[1].value.trim().toLowerCase();

  filteredData = originalData.filter(row => {
      const journalMatch = row[0].toLowerCase().includes(journalInput);
      const categoryMatch = categoryInput === "" || row[2].toLowerCase() === categoryInput;
      return journalMatch && categoryMatch;
  });

  // Reset pagination and re-render the table
  currentPage = 1;
  renderTableRows(filteredData);
  updatePagination(filteredData.length);
}


// Attach filter logic to all input fields
document.querySelectorAll('.filter-input').forEach(input => {
  input.addEventListener('input', filterData);
});
        
        fetch('datos.json')
          .then(response => response.json())
          .then(data => {
            originalData = data.map(row => Object.values(row));
            filteredData = [...originalData];
            renderTableRows(filteredData);
            updatePagination(filteredData.length);
          })
          .catch(error => console.error('Error loading data:', error));
      </script>
    </body>
    </html>